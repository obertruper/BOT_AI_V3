# Модуль `trading`

Модуль `trading` содержит всю основную логику, связанную непосредственно с торговыми операциями. Он отвечает за обработку сигналов, создание и исполнение ордеров, а также за управление открытыми позициями и их отслеживание.

---

## Архитектура модуля

Логика модуля построена вокруг `TradingEngine`, который выступает в роли центрального координатора. Он использует асинхронные очереди для получения сигналов и отправки ордеров на исполнение. Каждый аспект торгового цикла вынесен в отдельный компонент:

- **Сигналы** (`signals/`) -> **Движок** (`engine.py`) -> **Ордера** (`orders/`) -> **Исполнение** (`execution/`) -> **Позиции** (`positions/`)

---

## Структура модуля

| Файл / Директория | Описание |
| :--- | :--- |
| **`engine.py`** | **(Ключевой компонент)** `TradingEngine`. Центральный асинхронный движок, который управляет очередями сигналов и ордеров, координируя работу всех остальных компонентов. |
| **`execution/`** | Отвечает за фактическое исполнение ордеров на бирже. `executor.py` содержит `ExecutionEngine` с логикой агрессивного, пассивного и "умного" исполнения, а также механизмами повторных попыток. |
| **`orders/`** | Управление жизненным циклом ордеров. `order_manager.py` отвечает за создание, валидацию и отслеживание статуса ордеров. |
| **`positions/`** | Управление портфелем открытых позиций. `position_manager.py` отслеживает текущие позиции, их PnL и общую экспозицию. |
| **`position_tracker.py`** | `EnhancedPositionTracker`. Более продвинутая система отслеживания позиций с health-check, синхронизацией с биржей и сохранением в БД. **Примечание:** Функциональность частично пересекается с `PositionManager`. |
| **`sltp/`** | Содержит `EnhancedSLTPManager` и другую логику, связанную с управлением Stop Loss и Take Profit ордерами, включая трейлинг-стопы и частичное закрытие. |
| **`signals/`** | Обработка и валидация входящих торговых сигналов. `signal_processor.py` преобразует сигналы в готовые к исполнению ордера. |
| **`order_executor.py`** | Альтернативная реализация исполнителя ордеров. **Примечание:** Функциональность дублирует `execution/executor.py` и является кандидатом на рефакторинг/удаление. |
