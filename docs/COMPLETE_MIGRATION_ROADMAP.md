# üöÄ –ö–æ–º–ø–ª–µ–∫—Å–Ω—ã–π –ø–ª–∞–Ω –º–∏–≥—Ä–∞—Ü–∏–∏ BOT Trading v2 ‚Üí v3

## üìå –†–µ–∑—é–º–µ —Ç–µ–∫—É—â–µ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è

### –ß—Ç–æ —É–∂–µ –≥–æ—Ç–æ–≤–æ –≤ v3

- ‚úÖ –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ (SystemOrchestrator, TradingEngine)
- ‚úÖ PatchTST ML –º–æ–¥–µ–ª—å –ø–µ—Ä–µ–Ω–µ—Å–µ–Ω–∞ (models/saved/best_model_20250728_215703.pth)
- ‚úÖ –í–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å (FastAPI + React)
- ‚úÖ –ú—É–ª—å—Ç–∏-–±–∏—Ä–∂–µ–≤–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞ (7 –±–∏—Ä–∂)
- ‚úÖ –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ (–Ω–æ —Å –¥—Ä—É–≥–∏–º–∏ –º–æ–¥–µ–ª—è–º–∏)

### –ß—Ç–æ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç

- ‚ùå Telegram –±–æ—Ç (–æ—Å–Ω–æ–≤–Ω–æ–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –≤ v2)
- ‚ùå XGBoost –º–æ–¥–µ–ª–∏ (—Ä–∞–±–æ—á–∏–µ ML –∏–∑ v2)
- ‚ùå –ú–∏–≥—Ä–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö –∏–∑ v2
- ‚ùå –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è API –∫–ª—é—á–µ–π –±–∏—Ä–∂
- ‚ùå Enhanced SL/TP —Å–∏—Å—Ç–µ–º–∞ –∏–∑ v2

## üéØ –°—Ç—Ä–∞—Ç–µ–≥–∏—è –º–∏–≥—Ä–∞—Ü–∏–∏

### –ü—Ä–∏–Ω—Ü–∏–ø—ã

1. **–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏ v2** - v2 –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –≤–æ –≤—Ä–µ–º—è –º–∏–≥—Ä–∞—Ü–∏–∏
2. **–ü–æ—Å—Ç–µ–ø–µ–Ω–Ω—ã–π –ø–µ—Ä–µ—Ö–æ–¥** - –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –º–∏–≥—Ä–∏—Ä—É—é—Ç –ø–æ –æ—á–µ—Ä–µ–¥–∏
3. **–ì–∏–±—Ä–∏–¥–Ω—ã–π ML –ø–æ–¥—Ö–æ–¥** - –∏—Å–ø–æ–ª—å–∑—É–µ–º –æ–±–µ –º–æ–¥–µ–ª–∏ (XGBoost + PatchTST)
4. **–ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –ë–î** - —Ä–∞—Å—à–∏—Ä—è–µ–º —Å—Ç—Ä—É–∫—Ç—É—Ä—É v2, –Ω–µ –ª–æ–º–∞–µ–º

## üìÖ –ü–ª–∞–Ω –ø–æ –¥–Ω—è–º (14 –¥–Ω–µ–π)

### –î–µ–Ω—å 1-2: –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã

```bash
# 1. –†–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ v2
cd /mnt/SSD/PYCHARMPRODJECT/BOT_AI_V2
./backup_all.sh

# 2. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ë–î –¥–ª—è v3
# –ò—Å–ø–æ–ª—å–∑—É–µ–º —Ç—É –∂–µ –ë–î bot_trading_v3 –Ω–∞ –ø–æ—Ä—Ç—É 5555
# –ü—Ä–æ–≤–µ—Ä—è–µ–º –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ
cd /mnt/SSD/PYCHARMPRODJECT/BOT_AI_V3
python database/connections/postgres.py

# 3. –ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–π
cp BOT_AI_V2/BOT_Trading/BOT_Trading/config.yaml config/legacy_v2_config.yaml
cp BOT_AI_V2/BOT_Trading/BOT_Trading/.env .env.v2_backup
```

### –î–µ–Ω—å 3-4: –ú–∏–≥—Ä–∞—Ü–∏—è Telegram –±–æ—Ç–∞

```python
# –°–æ–∑–¥–∞–µ–º notifications/telegram/ —Å—Ç—Ä—É–∫—Ç—É—Ä—É
mkdir -p notifications/telegram
cp -r BOT_AI_V2/BOT_Trading/BOT_Trading/api/telegram_bot.py notifications/telegram/
cp -r BOT_AI_V2/BOT_Trading/BOT_Trading/utils/telegram_utils.py notifications/telegram/

# –ê–¥–∞–ø—Ç–∏—Ä—É–µ–º –ø–æ–¥ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—É—é –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É
# –°–æ–∑–¥–∞–µ–º TelegramNotificationService –¥–ª—è v3
```

### –î–µ–Ω—å 5-7: –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è ML –º–æ–¥–µ–ª–µ–π

```python
# 1. –ö–æ–ø–∏—Ä—É–µ–º XGBoost –º–æ–¥–µ–ª–∏
cp -r BOT_AI_V2/BOT_Trading/BOT_Trading/models/combined_model_* models/xgboost/

# 2. –°–æ–∑–¥–∞–µ–º —É–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–π ML –º–µ–Ω–µ–¥–∂–µ—Ä
# ml/unified_manager.py - —Ä–∞–±–æ—Ç–∞–µ—Ç —Å –æ–±–µ–∏–º–∏ –º–æ–¥–µ–ª—è–º–∏

# 3. –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é
# config/ml/ml_config.yaml - –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –æ–±–µ–∏—Ö –º–æ–¥–µ–ª–µ–π
```

### –î–µ–Ω—å 8-9: –ú–∏–≥—Ä–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö

```bash
# 1. –í—ã—Ä–∞–≤–Ω–∏–≤–∞–Ω–∏–µ —Å—Ç—Ä—É–∫—Ç—É—Ä –ë–î
python scripts/align_database_schema.py

# 2. –ú–∏–≥—Ä–∞—Ü–∏—è —Ç–æ—Ä–≥–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö
python scripts/migrate_v2_data.py --source=v2 --target=v3

# 3. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏
python scripts/verify_migration.py
```

### –î–µ–Ω—å 10-11: –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤

```python
# 1. Enhanced SL/TP –∏–∑ v2
cp -r BOT_AI_V2/BOT_Trading/BOT_Trading/trading/sltp/ trading/risk/enhanced_sltp/

# 2. Webhook –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –¥–ª—è TradingView
# –ê–¥–∞–ø—Ç–∏—Ä—É–µ–º webhook_server.py –ø–æ–¥ v3 –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É

# 3. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ SystemOrchestrator
# –î–æ–±–∞–≤–ª—è–µ–º Telegram –∏ ML –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
```

### –î–µ–Ω—å 12-13: –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

```bash
# 1. –ó–∞–ø—É—Å–∫ –≤ —Ç–µ—Å—Ç–æ–≤–æ–º —Ä–µ–∂–∏–º–µ
ENVIRONMENT=test python main.py

# 2. –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã–π –∑–∞–ø—É—Å–∫ v2 –∏ v3
# v2 –Ω–∞ –æ—Å–Ω–æ–≤–Ω–æ–º —Å–µ—Ä–≤–µ—Ä–µ
# v3 –Ω–∞ COPE —Å–µ—Ä–≤–µ—Ä–µ –¥–ª—è —Ç–µ—Å—Ç–æ–≤

# 3. –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
python scripts/compare_v2_v3_performance.py
```

### –î–µ–Ω—å 14: –†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ

```bash
# 1. –§–∏–Ω–∞–ª—å–Ω–æ–µ —Ä–µ–∑–µ—Ä–≤–∏—Ä–æ–≤–∞–Ω–∏–µ
./create_final_backup.sh

# 2. –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –Ω–∞ v3
systemctl stop bot-trading-v2
systemctl start bot-trading-v3

# 3. –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥
tail -f logs/trading_*.log
```

## üîß –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏

### –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö

```sql
-- –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ —Ç–∞–±–ª–∏—Ü v2 –¥–ª—è v3
ALTER TABLE trades ADD COLUMN IF NOT EXISTS trader_id VARCHAR(100);
ALTER TABLE trades ADD COLUMN IF NOT EXISTS exchange VARCHAR(50);
ALTER TABLE trades ADD COLUMN IF NOT EXISTS strategy_name VARCHAR(100);

-- –ù–æ–≤—ã–µ —Ç–∞–±–ª–∏—Ü—ã –¥–ª—è v3
CREATE TABLE IF NOT EXISTS ml_predictions (
    id SERIAL PRIMARY KEY,
    model_type VARCHAR(50),  -- 'xgboost' –∏–ª–∏ 'patchtst'
    signal_id INTEGER,
    predictions JSONB,
    confidence FLOAT,
    created_at TIMESTAMP DEFAULT NOW()
);
```

### –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

```yaml
# config/system.yaml
system:
  version: "3.0"
  compatibility_mode: true  # –ü–æ–¥–¥–µ—Ä–∂–∫–∞ v2 –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤

database:
  port: 5555  # –í–ê–ñ–ù–û: –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø–æ—Ä—Ç!
  user: obertruper

telegram:
  enabled: true
  legacy_mode: true  # –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∫–æ–¥ –∏–∑ v2

ml_models:
  ensemble: true  # –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –æ–±–µ –º–æ–¥–µ–ª–∏
  xgboost:
    enabled: true
    path: "models/xgboost/"
  patchtst:
    enabled: true
    path: "models/saved/best_model_20250728_215703.pth"
```

### API –∫–ª—é—á–∏

```bash
# –ö–æ–ø–∏—Ä—É–µ–º –∏–∑ v2 .env
BYBIT_API_KEY=xxx
BYBIT_API_SECRET=xxx
BINANCE_API_KEY=xxx
BINANCE_API_SECRET=xxx
# ... –æ—Å—Ç–∞–ª—å–Ω—ã–µ –±–∏—Ä–∂–∏

# Telegram
TELEGRAM_BOT_TOKEN=xxx
TELEGRAM_CHAT_ID=xxx
```

## üö® –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ —Ç–æ—á–∫–∏ –ø—Ä–æ–≤–µ—Ä–∫–∏

### –ü–æ—Å–ª–µ –∫–∞–∂–¥–æ–≥–æ —ç—Ç–∞–ø–∞

1. ‚úÖ –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –¥–æ—Å—Ç—É–ø–Ω–∞ –∏ –¥–∞–Ω–Ω—ã–µ —Ü–µ–ª—ã
2. ‚úÖ Telegram –±–æ—Ç –æ—Ç–≤–µ—á–∞–µ—Ç –Ω–∞ –∫–æ–º–∞–Ω–¥—ã
3. ‚úÖ ML –º–æ–¥–µ–ª–∏ –¥–µ–ª–∞—é—Ç –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è
4. ‚úÖ –¢–æ—Ä–≥–æ–≤—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
5. ‚úÖ –õ–æ–≥–∏ –Ω–µ —Å–æ–¥–µ—Ä–∂–∞—Ç –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –æ—à–∏–±–æ–∫

### –ü—Ä–æ—Ü–µ–¥—É—Ä–∞ –æ—Ç–∫–∞—Ç–∞

```bash
# –í —Å–ª—É—á–∞–µ –ø—Ä–æ–±–ª–µ–º
systemctl stop bot-trading-v3
systemctl start bot-trading-v2

# –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –ë–î –µ—Å–ª–∏ –Ω—É–∂–Ω–æ
psql -p 5555 -U obertruper bot_trading_v3 < backup_v2_latest.sql
```

## üìä –ú–µ—Ç—Ä–∏–∫–∏ —É—Å–ø–µ—Ö–∞

- **Downtime**: < 1 —á–∞—Å
- **–ü–æ—Ç–µ—Ä—è –¥–∞–Ω–Ω—ã—Ö**: 0%
- **–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å**: 100% v2 + –Ω–æ–≤—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ v3
- **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å**: —É–ª—É—á—à–µ–Ω–∏–µ –Ω–∞ 30-50% –∑–∞ —Å—á–µ—Ç async
- **ML —Ç–æ—á–Ω–æ—Å—Ç—å**: —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∏–ª–∏ —É–ª—É—á—à–µ–Ω–∏–µ

## üéØ –†–µ–∑—É–ª—å—Ç–∞—Ç –º–∏–≥—Ä–∞—Ü–∏–∏

–ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–π –º–∏–≥—Ä–∞—Ü–∏–∏ –ø–æ–ª—É—á–∞–µ–º:

1. **–°–æ–≤—Ä–µ–º–µ–Ω–Ω—É—é –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—É—é –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É** —Å –æ–±—Ä–∞—Ç–Ω–æ–π —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å—é
2. **–ì–∏–±—Ä–∏–¥–Ω—É—é ML —Å–∏—Å—Ç–µ–º—É** (XGBoost + PatchTST)
3. **–ü–æ–ª–Ω–æ—Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π Telegram –±–æ—Ç** + –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
4. **–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤—Å–µ—Ö –¥–∞–Ω–Ω—ã—Ö –∏ –∏—Å—Ç–æ—Ä–∏–∏**
5. **–ì–æ—Ç–æ–≤–Ω–æ—Å—Ç—å –∫ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏—é** –∏ –Ω–æ–≤—ã–º —Ñ—É–Ω–∫—Ü–∏—è–º

## üìù –ß–µ–∫-–ª–∏—Å—Ç –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ –∫ –∑–∞–ø—É—Å–∫—É

- [ ] –í—Å–µ —Ä–µ–∑–µ—Ä–≤–Ω—ã–µ –∫–æ–ø–∏–∏ —Å–æ–∑–¥–∞–Ω—ã
- [ ] –ë–î –º–∏–≥—Ä–∏—Ä–æ–≤–∞–Ω–∞ –∏ –ø—Ä–æ–≤–µ—Ä–µ–Ω–∞
- [ ] Telegram –±–æ—Ç –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω –∏ —Ä–∞–±–æ—Ç–∞–µ—Ç
- [ ] ML –º–æ–¥–µ–ª–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω—ã (–æ–±–µ)
- [ ] API –∫–ª—é—á–∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã
- [ ] –¢–µ—Å—Ç—ã –ø—Ä–æ–π–¥–µ–Ω—ã
- [ ] –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –Ω–∞—Å—Ç—Ä–æ–µ–Ω
- [ ] –ü–ª–∞–Ω –æ—Ç–∫–∞—Ç–∞ –≥–æ—Ç–æ–≤

---

**–ù–∞—á–∞–ª–æ –º–∏–≥—Ä–∞—Ü–∏–∏**: _____________
**–ü–ª–∞–Ω–∏—Ä—É–µ–º–æ–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ**: _____________
**–û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã–π**: _____________
