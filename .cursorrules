# Cursor Rules for BOT_AI_V3

## üö® –ö–†–ò–¢–ò–ß–ï–°–ö–ò –í–ê–ñ–ù–û

1. **PostgreSQL –ø–æ—Ä—Ç 5555** - –ù–ï 5432! –í—Å–µ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑—É–π: `PGPORT=5555`
2. **–ê–∫—Ç–∏–≤–∏—Ä—É–π venv –ø–µ—Ä–≤—ã–º**: `source venv/bin/activate` –ø–µ—Ä–µ–¥ –õ–Æ–ë–û–ô –∫–æ–º–∞–Ω–¥–æ–π
3. **API –∫–ª—é—á–∏ –¢–û–õ–¨–ö–û –≤ .env** - –Ω–∏–∫–æ–≥–¥–∞ –Ω–µ —Ö–∞—Ä–¥–∫–æ–¥—å —Å–µ–∫—Ä–µ—Ç—ã
4. **–¢–æ–ª—å–∫–æ async/await –∫–æ–¥** - –∏—Å–ø–æ–ª—å–∑—É–π `async def`, `await`, `asyncio`
5. **Python 3.8+** —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–∞

## –û –ø—Ä–æ–µ–∫—Ç–µ

BOT Trading v3 - –≤—ã—Å–æ–∫–æ–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–∞—è –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞ –∞–ª–≥–æ—Ä–∏—Ç–º–∏—á–µ—Å–∫–æ–π —Ç–æ—Ä–≥–æ–≤–ª–∏ –∫—Ä–∏–ø—Ç–æ–≤–∞–ª—é—Ç–∞–º–∏ —Å ML-–ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è–º–∏.

- **–ú–∞—Å—à—Ç–∞–±**: 673 —Ñ–∞–π–ª–∞, 207K+ —Å—Ç—Ä–æ–∫ –∫–æ–¥–∞
- **Stack**: Python 3.8+, PostgreSQL 15+, FastAPI, PyTorch
- **–ü–æ–¥–¥–µ—Ä–∂–∫–∞**: 7 –±–∏—Ä–∂, 50+ —Ç–æ—Ä–≥–æ–≤—ã—Ö –ø–∞—Ä
- **ML**: UnifiedPatchTST –º–æ–¥–µ–ª—å, 240+ features

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

### –ì–ª–∞–≤–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
- `unified_launcher.py` - —Ç–æ—á–∫–∞ –≤—Ö–æ–¥–∞, —É–ø—Ä–∞–≤–ª—è–µ—Ç –≤—Å–µ–º–∏ –ø—Ä–æ—Ü–µ—Å—Å–∞–º–∏
- `main.py` - —Ç–æ—Ä–≥–æ–≤–æ–µ —è–¥—Ä–æ
- `core/system/orchestrator.py` - –∫–æ–æ—Ä–¥–∏–Ω–∞—Ü–∏—è –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
- `trading/engine.py` - —Ç–æ—Ä–≥–æ–≤–∞—è –ª–æ–≥–∏–∫–∞
- `ml/logic/patchtst_model.py` - ML –º–æ–¥–µ–ª—å

### –ü–æ—Ç–æ–∫ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
1. UnifiedLauncher –∑–∞–ø—É—Å–∫–∞–µ—Ç –ø—Ä–æ—Ü–µ—Å—Å—ã
2. SystemOrchestrator –∫–æ–æ—Ä–¥–∏–Ω–∏—Ä—É–µ—Ç
3. –°—Ç—Ä–∞—Ç–µ–≥–∏–∏ ‚Üí —Å–∏–≥–Ω–∞–ª—ã ‚Üí TradingEngine
4. RiskManager ‚Üí OrderManager ‚Üí –±–∏—Ä–∂–∏
5. –†–µ–∑—É–ª—å—Ç–∞—Ç—ã ‚Üí PostgreSQL:5555

## –°—Ç–∞–Ω–¥–∞—Ä—Ç—ã –∫–æ–¥–∞

### Python
- **Async –≤–µ–∑–¥–µ**: –≤—Å–µ I/O –æ–ø–µ—Ä–∞—Ü–∏–∏ —á–µ—Ä–µ–∑ async/await
- **Type hints –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã**: `def process(signal: Signal) -> Order:`
- **Docstrings**: Google style –¥–ª—è –≤—Å–µ—Ö –ø—É–±–ª–∏—á–Ω—ã—Ö –º–µ—Ç–æ–¥–æ–≤
- **Imports**: –∞–±—Å–æ–ª—é—Ç–Ω—ã–µ –ø—É—Ç–∏ –æ—Ç –∫–æ—Ä–Ω—è –ø—Ä–æ–µ–∫—Ç–∞

### –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
```bash
black . && ruff check --fix .  # –ü–µ—Ä–µ–¥ –∫–∞–∂–¥—ã–º –∫–æ–º–º–∏—Ç–æ–º
mypy . --ignore-missing-imports  # –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–∏–ø–æ–≤
```

### –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
- –ú–∏–Ω–∏–º—É–º 80% –ø–æ–∫—Ä—ã—Ç–∏–µ –¥–ª—è –Ω–æ–≤—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π
- –ò—Å–ø–æ–ª—å–∑—É–π pytest –∏ pytest-asyncio
- –ú–æ–∫–∏ –¥–ª—è –≤–Ω–µ—à–Ω–∏—Ö —Å–µ—Ä–≤–∏—Å–æ–≤ (–±–∏—Ä–∂–∏, API)

## –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö

- **–ü–æ—Ä—Ç**: 5555 (–ù–ï 5432!)
- **–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å**: obertruper
- **–ë–∞–∑–∞**: bot_trading_v3
- **–ú–∏–≥—Ä–∞—Ü–∏–∏**: Alembic

### –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ
```python
# Async (–ø—Ä–µ–¥–ø–æ—á—Ç–∏—Ç–µ–ª—å–Ω–æ)
from database.connections.postgres import AsyncPGPool
data = await AsyncPGPool.fetch("SELECT * FROM orders")

# SQLAlchemy async
from database.connections import get_async_db
async with get_async_db() as db:
    result = await db.execute(query)
```

## ML —Å–∏—Å—Ç–µ–º–∞

- **–ú–æ–¥–µ–ª—å**: UnifiedPatchTST (PyTorch Transformer)
- **Features**: 240+ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏—Ö –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤
- **–ö–æ–Ω—Ç–µ–∫—Å—Ç**: 96 —Ç–æ—á–µ–∫ (24 —á–∞—Å–∞ @ 15 –º–∏–Ω)
- **GPU**: RTX 5090 –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è
- **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å**: <20ms inference, F1>0.4

## –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

1. **–ù–∏–∫–æ–≥–¥–∞ –Ω–µ –∫–æ–º–º–∏—Ç—å .env —Ñ–∞–π–ª**
2. **–ü—Ä–æ–≤–µ—Ä—è–π –ø–µ—Ä–µ–¥ –∫–æ–º–º–∏—Ç–æ–º**: `git diff --staged | grep -i "api_key\|secret"`
3. **–í–∞–ª–∏–¥–∞—Ü–∏—è –≤—Å–µ—Ö –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö**
4. **–ò—Å–ø–æ–ª—å–∑—É–π –ø–∞—Ä–∞–º–µ—Ç—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–µ SQL –∑–∞–ø—Ä–æ—Å—ã**

## –ß–∞—Å—Ç—ã–µ –∫–æ–º–∞–Ω–¥—ã

```bash
# –ó–∞–ø—É—Å–∫ —Å–∏—Å—Ç–µ–º—ã
python3 unified_launcher.py

# –¢–æ–ª—å–∫–æ —Ç–æ—Ä–≥–æ–≤–ª—è
python3 unified_launcher.py --mode=core

# –° ML
python3 unified_launcher.py --mode=ml

# –¢–µ—Å—Ç—ã
pytest tests/unit/ -v --cov

# –õ–æ–≥–∏
tail -f data/logs/trading.log
```

## –û—Ç–ª–∞–¥–∫–∞

### Import errors
```bash
source venv/bin/activate
pip install -r requirements.txt
```

### DB connection failed
```bash
psql -p 5555 -U obertruper -d bot_trading_v3
```

### ML –Ω–µ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ —Å–∏–≥–Ω–∞–ª—ã
- –ü—Ä–æ–≤–µ—Ä—å –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ ml_signal_processor.py
- TTL –∫—ç—à–∞ –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å 5 –º–∏–Ω—É—Ç, –Ω–µ –±–æ–ª—å—à–µ

## –ü—Ä–∞–≤–∏–ª–∞ Cursor

1. **–ê–≤—Ç–æ-–∞–∫—Ç–∏–≤–∞—Ü–∏—è venv** –ø—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏ —Ç–µ—Ä–º–∏–Ω–∞–ª–∞
2. **–ü—Ä–æ–≤–µ—Ä–∫–∞ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è** –ø–µ—Ä–µ–¥ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º
3. **–ü–æ–¥—Å–≤–µ—Ç–∫–∞ async/await** –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã—Ö –º–µ—Å—Ç
4. **–í–∞–ª–∏–¥–∞—Ü–∏—è SQL** –∑–∞–ø—Ä–æ—Å–æ–≤ –Ω–∞ –ø–æ—Ä—Ç 5555
5. **–ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ** –ø—Ä–∏ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏ .env

## –ü–æ–ª–µ–∑–Ω—ã–µ —Å—Å—ã–ª–∫–∏

- API –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è: http://localhost:8080/api/docs
- Frontend: http://localhost:5173
- Prometheus –º–µ—Ç—Ä–∏–∫–∏: http://localhost:9090
- Grafana –¥–∞—à–±–æ—Ä–¥—ã: http://localhost:3000

## –ö–æ–Ω—Ç–∞–∫—Ç—ã –∏ –ø–æ–¥–¥–µ—Ä–∂–∫–∞

- GitHub Issues: –¥–ª—è –±–∞–≥–æ–≤ –∏ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–π
- –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è: /docs/ –ø–∞–ø–∫–∞ –≤ –ø—Ä–æ–µ–∫—Ç–µ
- ML –≥–∞–π–¥—ã: ML_SIGNAL_EVALUATION_SYSTEM.md, ML_TUNING_GUIDE.md
