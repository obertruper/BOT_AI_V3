# Модуль `database`

Модуль `database` инкапсулирует всю логику для взаимодействия с базой данных PostgreSQL. Он предоставляет структурированный и безопасный слой доступа к данным для всех компонентов торговой системы.

---

## Архитектура и технологии

- **База данных:** `PostgreSQL` (порт `5555`).
- **ORM:** `SQLAlchemy 2.0` используется для определения моделей данных и взаимодействия с БД в объектно-ориентированном стиле.
- **Асинхронность:** `asyncpg` используется как драйвер для обеспечения высокопроизводительного асинхронного доступа к базе данных.
- **Миграции:** `Alembic` применяется для управления версиями и миграциями схемы базы данных.

Архитектура слоя данных построена на трех основных компонентах:
1.  **Connections:** Управление пулом соединений.
2.  **Models:** Определение схемы таблиц через ORM.
3.  **Repositories:** Инкапсуляция логики запросов к данным (Data Access Layer).

---

## Структура модуля

| Директория | Описание |
| :--- | :--- |
| **`connections/`** | Управляет подключением к PostgreSQL. `postgres.py` настраивает синхронный и асинхронный движки `SQLAlchemy`, а также предоставляет пулы соединений для `asyncpg`. |
| **`models/`** | Определяет ORM-модели, которые соответствуют таблицам в базе данных. `base_models.py` содержит базовые модели (`Order`, `Trade`), а остальные файлы определяют специфические таблицы (`market_data`, `ml_predictions`). |
| **`repositories/`** | Реализует паттерн "Репозиторий". Каждый файл (например, `trade_repository.py`) содержит класс, который предоставляет методы для выполнения CRUD-операций (Create, Read, Update, Delete) для конкретной модели, скрывая детали SQL-запросов. |
| **`migrations/`** | Содержит конфигурацию `Alembic` (`env.py`), которая используется для автоматической генерации и применения миграций схемы базы данных. Сами файлы миграций находятся в корневой папке `alembic/versions/`. |
