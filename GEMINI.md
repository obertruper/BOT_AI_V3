# GEMINI.md (–§–∏–Ω–∞–ª—å–Ω–∞—è –≤–µ—Ä—Å–∏—è)

–ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –¥–ª—è Google Gemini CLI –ø—Ä–∏ —Ä–∞–±–æ—Ç–µ —Å –ø—Ä–æ–µ–∫—Ç–æ–º BOT_AI_V3

## üìñ –û –ø—Ä–æ–µ–∫—Ç–µ

BOT_AI_V3 - —ç—Ç–æ –≤—ã—Å–æ–∫–æ–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–∞—è, –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è —Ç–æ—Ä–≥–æ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞ —Å –æ—Ç–∫—Ä—ã—Ç–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–æ–π –¥–ª—è —Ä–∞–±–æ—Ç—ã –Ω–∞ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –∫—Ä–∏–ø—Ç–æ–≤–∞–ª—é—Ç–Ω—ã—Ö –±–∏—Ä–∂–∞—Ö. –Ø–¥—Ä–æ–º —Å–∏—Å—Ç–µ–º—ã —è–≤–ª—è–µ—Ç—Å—è –º—É–ª—å—Ç–∏-—Ç—Ä–µ–π–¥–µ—Ä–Ω–∞—è –º–æ–¥–µ–ª—å, –ø–æ–∑–≤–æ–ª—è—é—â–∞—è –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ –∑–∞–ø—É—Å–∫–∞—Ç—å –Ω–µ–∑–∞–≤–∏—Å–∏–º—ã—Ö —Ç–æ—Ä–≥–æ–≤—ã—Ö –∞–≥–µ–Ω—Ç–æ–≤ —Å —Ä–∞–∑–ª–∏—á–Ω—ã–º–∏ —Å—Ç—Ä–∞—Ç–µ–≥–∏—è–º–∏. –°–∏—Å—Ç–µ–º–∞ –≥–ª—É–±–æ–∫–æ –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω–∞ —Å ML-–º–æ–¥–µ–ª—è–º–∏ –¥–ª—è –ø—Ä–∏–Ω—è—Ç–∏—è —Ç–æ—Ä–≥–æ–≤—ã—Ö —Ä–µ—à–µ–Ω–∏–π.

- **–¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏**: Python 3.12, FastAPI, PostgreSQL, React, PyTorch, Pydantic
- **–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞**: –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è, –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–Ω–∞—è, —É–ø—Ä–∞–≤–ª—è–µ–º–∞—è —Å–æ–±—ã—Ç–∏—è–º–∏.
- **–ö–ª—é—á–µ–≤—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã**: `Adapter` (–¥–ª—è ML-–º–æ–¥–µ–ª–µ–π), `Factory` (–¥–ª—è —Ç—Ä–µ–π–¥–µ—Ä–æ–≤ –∏ –±–∏—Ä–∂), `Repository` –∏ `Unit of Work` (–¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –ë–î).

## ‚ùó –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω–æ–µ

1.  **PostgreSQL –ø–æ—Ä—Ç 5555** - –ù–ï 5432! –í—Å–µ–≥–¥–∞: `PGPORT=5555`
2.  **–ê–∫—Ç–∏–≤–∞—Ü–∏—è venv**: `source venv/bin/activate` –ø–µ—Ä–µ–¥ –õ–Æ–ë–û–ô –∫–æ–º–∞–Ω–¥–æ–π.
3.  **–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è**: –í—Å—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ `config/config.yaml` –∏ –≤–∞–ª–∏–¥–∏—Ä—É–µ—Ç—Å—è —á–µ—Ä–µ–∑ Pydantic-–º–æ–¥–µ–ª–∏ –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ.
4.  **Async/await –≤–µ–∑–¥–µ**: –í—Å–µ I/O –æ–ø–µ—Ä–∞—Ü–∏–∏ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–º–∏.
5.  **Hedge Mode**: –°–∏—Å—Ç–µ–º–∞ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ —Ä–µ–∂–∏–º–µ —Ö–µ–¥–∂–∏—Ä–æ–≤–∞–Ω–∏—è –Ω–∞ Bybit.

## üöÄ –ë—ã—Å—Ç—Ä—ã–π –∑–∞–ø—É—Å–∫

```bash
# –ê–∫—Ç–∏–≤–∞—Ü–∏—è –æ–∫—Ä—É–∂–µ–Ω–∏—è
source venv/bin/activate

# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
pip install -r requirements.txt

# –ó–∞–ø—É—Å–∫ —Å–∏—Å—Ç–µ–º—ã —Å —Ñ–∏–ª—å—Ç—Ä–æ–≤–∞–Ω–Ω—ã–º–∏ –ª–æ–≥–∞–º–∏
./start_with_logs_filtered.sh
```

## üèõÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è

### 1. –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–µ–π (`core/config`)
- **–ï–¥–∏–Ω—ã–π –∏—Å—Ç–æ—á–Ω–∏–∫**: –í—Å—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Ö—Ä–∞–Ω–∏—Ç—Å—è –≤ `config/config.yaml`.
- **Pydantic-–≤–∞–ª–∏–¥–∞—Ü–∏—è**: –ü—Ä–∏ –∑–∞–ø—É—Å–∫–µ —Ñ–∞–π–ª `config.yaml` –≤–∞–ª–∏–¥–∏—Ä—É–µ—Ç—Å—è —Å –ø–æ–º–æ—â—å—é Pydantic-–º–æ–¥–µ–ª–∏ `RootConfig` –∏–∑ `core/config/models.py`. –≠—Ç–æ –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç—å –∏ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å –≤—Å–µ—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤.
- **–¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–π –¥–æ—Å—Ç—É–ø**: `ConfigManager` –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç —Ç–∏–ø–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –¥–æ—Å—Ç—É–ø –∫–æ –≤—Å–µ–º –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏.

### 2. –î–æ—Å—Ç—É–ø –∫ –¥–∞–Ω–Ω—ã–º (`database/`)
- **Repository Pattern**: –í—Å—è –ª–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç—ã —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö –∏–Ω–∫–∞–ø—Å—É–ª–∏—Ä–æ–≤–∞–Ω–∞ –≤ –∫–ª–∞—Å—Å–∞—Ö-—Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è—Ö (`TradeRepository`, `SignalRepository` –∏ —Ç.–¥.).
- **Unit of Work –∏ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏**: `TransactionManager` (`database/connections/transaction_manager.py`) –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –∞—Ç–æ–º–∞—Ä–Ω–æ—Å—Ç—å –æ–ø–µ—Ä–∞—Ü–∏–π. –í—Å–µ –∑–∞–ø—Ä–æ—Å—ã –∫ –ë–î –≤–Ω—É—Ç—Ä–∏ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–µ–≤ –¥–æ–ª–∂–Ω—ã –≤—ã–ø–æ–ª–Ω—è—Ç—å—Å—è —á–µ—Ä–µ–∑ `async with self.transaction_manager.transaction() as conn:`.

### 3. –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ ML (`ml/`)
- **Adapter Pattern**: –õ–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç—ã —Å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–º–∏ ML-–º–æ–¥–µ–ª—è–º–∏ –≤—ã–Ω–µ—Å–µ–Ω–∞ –≤ "–∞–¥–∞–ø—Ç–µ—Ä—ã" (–≤ `ml/adapters/`). –≠—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –ª–µ–≥–∫–æ –∑–∞–º–µ–Ω—è—Ç—å –∏–ª–∏ –¥–æ–±–∞–≤–ª—è—Ç—å –Ω–æ–≤—ã–µ –º–æ–¥–µ–ª–∏, –Ω–µ –∏–∑–º–µ–Ω—è—è –æ—Å–Ω–æ–≤–Ω—É—é –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫—É.
- **`BaseModelAdapter`**: –û–ø—Ä–µ–¥–µ–ª—è–µ—Ç –æ–±—â–∏–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è –≤—Å–µ—Ö –º–æ–¥–µ–ª–µ–π.
- **`PatchTSTAdapter`**: –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –∞–¥–∞–ø—Ç–µ—Ä–∞ –¥–ª—è —Ç–µ–∫—É—â–µ–π —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–µ—Ä–Ω–æ–π –º–æ–¥–µ–ª–∏.
- **`MLManager`**: –£–ø—Ä–∞–≤–ª—è–µ—Ç –∞–¥–∞–ø—Ç–µ—Ä–∞–º–∏ –∏ –¥–µ–ª–µ–≥–∏—Ä—É–µ—Ç –∏–º –∑–∞–¥–∞—á–∏ –ø–æ –∑–∞–≥—Ä—É–∑–∫–µ –º–æ–¥–µ–ª–µ–π –∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—é –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π.

## üõ†Ô∏è –ö–æ–º–∞–Ω–¥—ã –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏

### –ö–∞—á–µ—Å—Ç–≤–æ –∫–æ–¥–∞ (–û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û –ø–µ—Ä–µ–¥ –∫–æ–º–º–∏—Ç–æ–º)

–í –ø—Ä–æ–µ–∫—Ç–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `pre-commit` –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏ –∏ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∫–æ–¥–∞.

```bash
# –ü–µ—Ä–≤–æ–Ω–∞—á–∞–ª—å–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞:
pip install pre-commit
pre-commit install

# –†—É—á–Ω–æ–π –∑–∞–ø—É—Å–∫ –≤—Å–µ—Ö –ø—Ä–æ–≤–µ—Ä–æ–∫:
pre-commit run --all-files
```

### –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

```bash
# –ó–∞–ø—É—Å–∫ –≤—Å–µ—Ö —Ç–µ—Å—Ç–æ–≤
pytest

# –ó–∞–ø—É—Å–∫ —Ç–æ–ª—å–∫–æ unit –∏–ª–∏ integration —Ç–µ—Å—Ç–æ–≤
pytest -m unit -v
pytest -m integration -v
```

### –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö (–ø–æ—Ä—Ç 5555!)
```bash
# –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –ë–î
psql -p 5555 -U obertruper -d bot_trading_v3

# –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –º–∏–≥—Ä–∞—Ü–∏–π
alembic upgrade head
```

## üåê –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø—Ä–æ–µ–∫—Ç–∞

–í—Å—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ –ø—Ä–æ–µ–∫—Ç—É –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è —Å –ø–æ–º–æ—â—å—é `MkDocs` –∏ –¥–æ—Å—Ç—É–ø–Ω–∞ –≤ –≤–∏–¥–µ —É–¥–æ–±–Ω–æ–≥–æ –≤–µ–±-—Å–∞–π—Ç–∞.

1.  **–£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:**
    ```bash
    pip install -r requirements.txt
    ```
2.  **–ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–µ—Ä–≤–µ—Ä –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏:**
    ```bash
    mkdocs serve --dev-addr 127.0.0.1:8008
    ```
3.  **–û—Ç–∫—Ä–æ–π—Ç–µ –≤ –±—Ä–∞—É–∑–µ—Ä–µ:** `http://127.0.0.1:8008`
